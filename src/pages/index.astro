---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';
import Hero from '../components/Hero.astro';
import ServiceCard from '../components/ServiceCard.astro';
import ProjectCard from '../components/ProjectCard.astro';
import TestimonialCard from '../components/TestimonialCard.astro';
import BlogCard from '../components/BlogCard.astro';
import CTA from '../components/CTA.astro';

const allProjects = await getCollection('projects');
const featuredProjects = allProjects
  .filter((p) => p.data.featured)
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime());

const allPosts = await getCollection('blog', ({ data }) => !data.draft);
const latestPosts = allPosts
  .sort((a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime())
  .slice(0, 3);

const services = [
  {
    title: 'Modern Design',
    description: 'Clean, professional designs that reflect your brand and make a lasting first impression on every visitor.',
    icon: '<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M9.53 16.122a3 3 0 0 0-5.78 1.128 2.25 2.25 0 0 1-2.4 2.245 4.5 4.5 0 0 0 8.4-2.245c0-.399-.078-.78-.22-1.128Zm0 0a15.998 15.998 0 0 0 3.388-1.62m-5.043-.025a15.994 15.994 0 0 1 1.622-3.395m3.42 3.42a15.995 15.995 0 0 0 4.764-4.648l3.876-5.814a1.151 1.151 0 0 0-1.597-1.597L14.146 6.32a15.996 15.996 0 0 0-4.649 4.763m3.42 3.42a6.776 6.776 0 0 0-3.42-3.42" /></svg>',
  },
  {
    title: 'Fast Performance',
    description: 'Lightning-fast load times that keep visitors engaged and improve your search rankings on Google.',
    icon: '<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m3.75 13.5 10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75Z" /></svg>',
  },
  {
    title: 'SEO Optimised',
    description: 'Built with search engines in mind so your customers can actually find you when they search online.',
    icon: '<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z" /></svg>',
  },
  {
    title: 'Mobile Responsive',
    description: 'Every site looks and works perfectly on phones, tablets, and desktops — because your customers use all of them.',
    icon: '<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 1.5H8.25A2.25 2.25 0 0 0 6 3.75v16.5a2.25 2.25 0 0 0 2.25 2.25h7.5A2.25 2.25 0 0 0 18 20.25V3.75a2.25 2.25 0 0 0-2.25-2.25H13.5m-3 0V3h3V1.5m-3 0h3m-3 18.75h3" /></svg>',
  },
  {
    title: 'Conversion Focused',
    description: 'Strategic layouts and clear calls-to-action designed to turn visitors into paying customers.',
    icon: '<svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" d="M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z" /></svg>',
  },
];

const testimonials = [
  {
    quote: "nocoapi delivered a site that exceeded our expectations. The attention to detail and performance was outstanding — our page load times dropped by 60%.",
    name: "Sarah Mitchell",
    role: "Founder, Bloom Studio",
  },
  {
    quote: "Working with nocoapi was seamless from start to finish. They understood our vision immediately and translated it into a beautiful, functional website.",
    name: "James O'Brien",
    role: "Director, Coastal Properties",
  },
  {
    quote: "Our enquiries doubled within two months of launching the new site. The SEO foundations they built in were a game-changer for our business.",
    name: "Laura Chen",
    role: "Owner, Chen & Associates",
  },
];
---

<BaseLayout
  title="Web Design Dublin | nocoapi — Fast, Modern Websites"
  description="Professional web design and development in Dublin. Fast, modern websites built to convert visitors into customers. SEO, performance, and responsive design included."
>
  <!-- Hero -->
  <Hero />

  <!-- Services -->
  <section class="py-20 bg-gray-50">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="mx-auto max-w-2xl text-center">
        <h2 class="text-3xl font-bold text-navy-900 sm:text-4xl">Services</h2>
        <p class="mt-4 text-lg text-gray-600">Everything your business needs to succeed online.</p>
      </div>
      <div class="mt-12 grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {services.map((service) => (
          <ServiceCard {...service} />
        ))}
      </div>
      <div class="mt-10 text-center">
        <a href="/services" class="text-base font-medium text-primary-600 hover:text-primary-800 transition-colors">
          View All Services &rarr;
        </a>
      </div>
    </div>
  </section>

  <!-- Featured Projects -->
  <section class="py-20">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="mx-auto max-w-2xl text-center">
        <h2 class="text-3xl font-bold text-navy-900 sm:text-4xl">Featured Projects</h2>
        <p class="mt-4 text-lg text-gray-600">A selection of recent work across different industries.</p>
      </div>
      <div class="mt-12 grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
        {featuredProjects.map((project) => (
          <ProjectCard
            title={project.data.title}
            description={project.data.description}
            tags={project.data.tags}
            slug={project.id.replace(/\.mdx?$/, '')}
            liveUrl={project.data.liveUrl}
            thumbnail={project.data.thumbnail}
          />
        ))}
      </div>
      <div class="mt-12 text-center">
        <a href="/projects" class="text-base font-medium text-primary-600 hover:text-primary-800 transition-colors">
          View All Projects &rarr;
        </a>
      </div>
    </div>
  </section>

  <!-- Testimonials -->
  <section class="py-20 bg-gray-50">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <div class="mx-auto max-w-2xl text-center">
        <h2 class="text-3xl font-bold text-navy-900 sm:text-4xl">What clients say</h2>
        <p class="mt-4 text-lg text-gray-600">Feedback from businesses I've worked with.</p>
      </div>
      <div class="mt-12 grid grid-cols-1 gap-8 md:grid-cols-3">
        {testimonials.map((t) => (
          <TestimonialCard {...t} />
        ))}
      </div>
    </div>
  </section>

  <!-- Blog Preview -->
  {latestPosts.length > 0 && (
    <section class="py-20">
      <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
        <div class="mx-auto max-w-2xl text-center">
          <h2 class="text-3xl font-bold text-navy-900 sm:text-4xl">From the blog</h2>
          <p class="mt-4 text-lg text-gray-600">Tips and insights on web design, development, and growing your online presence.</p>
        </div>
        <div class="mt-12 grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-3">
          {latestPosts.map((post) => (
            <BlogCard
              title={post.data.title}
              description={post.data.description}
              slug={post.id.replace(/\.mdx?$/, '')}
              publishDate={post.data.publishDate}
              category={post.data.category}
            />
          ))}
        </div>
        <div class="mt-12 text-center">
          <a href="/blog" class="text-base font-medium text-primary-600 hover:text-primary-800 transition-colors">
            Read All Posts &rarr;
          </a>
        </div>
      </div>
    </section>
  )}

  <!-- CTA -->
  <CTA />
</BaseLayout>
